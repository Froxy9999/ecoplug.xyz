<%- include("../partials/head", { user, path, title: "Ecoplug - Profile",  url}) %>

<head>
	<link href="/css/profile.css" rel="stylesheet" type="text/css">
	<title></title>
</head>
	<div class="loading" id="loading">
		<div>
			Please wait while we upload your picture
		</div>
		<div class="lds-facebook">
			<div></div>
			<div></div>
			<div></div>
		</div>
	</div>
	<div class="profile-container">
		<div class="wrap-container">
     <div class="alert-validate"  id="hidden"></div>
     <% if(alert) { %><div class="alert-validate"><%= alert %></div><% } %>
			<form action="/profile/change_profile_picture" class="contact-form validate-form" enctype="multipart/form-data" id="form" method="post" name="form" role="form">
				<div class="main_profile">
        <img class="image" id="image" src="<%= user.profile.image ?  `/${user.profile.image}`: "/images/unknown_user.png" %>">
        <div class="middle">
        <div class="text"><label class="label">Upload Image<input id="image" name="image" onchange="changeImage()" style="display: none;" type="file"></input></label><%- user.profile.image ?  `<br><a onclick="resetImage()">Reset Image</a>`: "" %></div>
      
        </div>
					<h1><%= user.username %> - Profile Settings</h1>
					<p>Update Your profile and notification settings</p>
				</div>
			</form>
			<div class="info_box">

				<div class="title">
					<h2>Profile Information</h2>
				</div>
				<div class="info">
					<h3><b>Username</b></h3>
					<h5><%= user.username %></h5>
				</div>
				<div class="info">
					<h3><b>Email adress</b></h3>
					<h5><%= user.email %></h5>
				</div>
				<div class="info">
					<h3><b>Joined At</b></h3>
					<h5><%= moment(user.joinedAt || Date.now()).format('MMMM Do YYYY, h:mm:ss a') %> <b style="padding-left: 5px;">(<%=  moment(user.joinedAt || Date.now()).fromNow() %>)</b></h5>
				</div>
			</div>
			<div class="info_box">
				<div class="title">
					<h2>Notification Settings</h2>
				</div>
				<div class="info">
					<div class="list">
						<ul>
							<li>
								<div class="list-desc">
									<p class="list-title">Receive News and Updates</p>
								</div>
								<div class="notification-toggle">
                  <% if(user.profile.settings.news_and_updates) { %>
									<input onchange="notifications()" class="tgl tgl-ios" id="jg1" type="checkbox" checked> <% } else { %><input onchange="notifications()" class="tgl tgl-ios" id="jg1" type="checkbox"> 
                  <% } %><label class="tgl-btn" for="jg1"></label>
								</div>
							</li>
							<li>
								<div class="list-desc">
									<p class="list-title">Receive Product Updates</p>
								</div>
								<div class="notification-toggle">
                  <% if(user.profile.settings.product_updates) { %>
									<input onchange="notifications()" class="tgl tgl-ios" id="jg2" type="checkbox" checked> <% } else { %><input onchange="notifications()" class="tgl tgl-ios" id="jg2" type="checkbox"> 
                  <% } %><label class="tgl-btn" for="jg2"></label>
								</div>
							</li>
							<li>
								<div class="list-desc">
									<p class="list-title">Receive Account Changes</p>
								</div>
								<div class="notification-toggle">
                  <% if(user.profile.settings.account_changes) { %>
									<input onchange="notifications()" class="tgl tgl-ios" id="jg3" type="checkbox" checked> <% } else { %><input onchange="notifications()" class="tgl tgl-ios" id="jg3" type="checkbox"> <% } %><label class="tgl-btn" for="jg3"></label>
								</div>
							</li>
							<li>
								<div class="list-desc">
									<p class="list-title">Recieve Weekly Product statistics</p>
								</div>
								<div class="notification-toggle">
                <% if(user.profile.settings.weekly_statistics) { %><input onchange="notifications()"class="tgl tgl-ios" id="jg4" type="checkbox" checked><% } else { %><input onchange="notifications()"class="tgl tgl-ios" id="jg4" type="checkbox"><% } %><label class="tgl-btn" for="jg4"></label>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="info_box">
				<div class="title">
					<h2>Change Your Password</h2>
				</div>
        <form action="/profile/change_password" class="contact-form validate-form" id="pass" method="post" name="form" role="form">
				<div class="info">
					<h3><b>Old Password</b></h3><input class="input" id="oldpassword" name="oldpassword" placeholder="Old Password" type="password">
				</div>
				<div class="info">
					<h3><b>New Password</b></h3>
					<h5><input class="input" id="newpassword" name="newpassword" placeholder="New Password" type="password"></h5>
				</div>
				<div class="info">
					<button type="button" onclick="changeP()">Change Password</button>
				</div>
        </form>
			</div>
		</div>
	</div>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'>
	</script> 
	<script src='/js/profile.js'>
	</script> 
	<script>
	</script><%- include("../partials/homefooter") %> <%- include("../partials/footer") %>







<% if(path === "/profile/change_profile_picture") { %>
<script>
const loading = document.getElementById("loading");
loading.style.display = "block";
setTimeout(()=>{
window.location.href="/profile"
}, 4000)
</script>
<% } %>

